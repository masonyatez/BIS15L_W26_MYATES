mutate(injury = str_remove(injury, "*$"))
sharks %>%
select(county, injury) %>%
group_by(county, injury) %>%
summarize(
injury_count = n(),
.groups = "drop"
) %>%
mutate(injury = str_remove(injury, "*"))
sharks %>%
select(county, injury) %>%
group_by(county, injury) %>%
summarize(
injury_count = n(),
.groups = "drop"
) %>%
mutate(injury = str_remove(injury, "\\*"))
sharks %>%
select(county, injury) %>%
mutate(injury = str_remove(injury, "\\*")) %>%
group_by(county, injury) %>%
summarize(
injury_count = n(),
.groups = "drop"
)
sharks %>%
select(county, injury) %>%
mutate(injury = str_remove(injury, "\\*")) %>%
group_by(county, injury) %>%
summarize(
injury_count = n(),
.groups = "drop"
) %>%
pivot_wider(
names_from = injury,
values_from = injury_count
)
sharks %>%
select(county, injury) %>%
mutate(injury = str_remove(injury, "\\*")) %>%
group_by(county, injury) %>%
summarize(
injury_count = n(),
.groups = "drop"
) %>%
pivot_wider(
names_from = injury,
values_from = injury_count
)
sharks %>%
select(county, injury) %>%
mutate(injury = str_remove(injury, "\\*")) %>%
group_by(county, injury) %>%
summarize(
injury_count = n(),
.groups = "drop"
) %>%
pivot_wider(
names_from = injury,
values_from = injury_count
) %>%
mutate(
total.injuries = sum(c(minor,none,major,fatal))
)
sharks %>%
select(county, injury) %>%
mutate(injury = str_remove(injury, "\\*")) %>%
group_by(county, injury) %>%
summarize(
injury_count = n(),
.groups = "drop"
) %>%
pivot_wider(
names_from = injury,
values_from = injury_count
) %>%
mutate(
total.injuries = sum(c(minor,none,major,fatal), na.rm = TRUE)
)
sharks %>%
select(county, injury) %>%
mutate(injury = str_remove(injury, "\\*")) %>%
group_by(county, injury) %>%
summarize(
injury_count = n(),
.groups = "drop"
) %>%
pivot_wider(
names_from = injury,
values_from = injury_count
) %>%
group_by(county)
mutate(
total.injuries = sum(c(minor,none,major,fatal), na.rm = TRUE)
)
sharks %>%
select(county, injury) %>%
mutate(injury = str_remove(injury, "\\*")) %>%
group_by(county, injury) %>%
summarize(
injury_count = n(),
.groups = "drop"
) %>%
pivot_wider(
names_from = injury,
values_from = injury_count
) %>%
group_by(county) %>%
mutate(
total.injuries = sum(c(minor,none,major,fatal), na.rm = TRUE)
)
sharks %>%
select(county, injury) %>%
mutate(injury = str_remove(injury, "\\*")) %>%
group_by(county, injury) %>%
summarize(
injury_count = n(),
.groups = "drop"
) %>%
pivot_wider(
names_from = injury,
values_from = injury_count
) %>%
group_by(county) %>%
mutate(
total.injuries = sum(c(minor,major,fatal), na.rm = TRUE)
) %>%
relocate("minor", "fatal", "none", .after = "major")
sharks %>%
select(county, injury) %>%
mutate(injury = str_remove(injury, "\\*")) %>%
group_by(county, injury) %>%
summarize(
injury_count = n(),
.groups = "drop"
) %>%
pivot_wider(
names_from = injury,
values_from = injury_count
) %>%
group_by(county) %>%
mutate(
total.injuries = sum(c(minor,major,fatal), na.rm = TRUE)
) %>%
relocate("minor", "fatal", "none", .after = "major") %>%
arrange(total.injuries)
sharks %>%
select(county, injury) %>%
mutate(injury = str_remove(injury, "\\*")) %>%
group_by(county, injury) %>%
summarize(
injury_count = n(),
.groups = "drop"
) %>%
pivot_wider(
names_from = injury,
values_from = injury_count
) %>%
group_by(county) %>%
mutate(
total.injuries = sum(c(minor,major,fatal), na.rm = TRUE)
) %>%
relocate("minor", "fatal", "none", .after = "major") %>%
arrange(desc(total.injuries)
sharks %>%
select(county, injury) %>%
mutate(injury = str_remove(injury, "\\*")) %>%
group_by(county, injury) %>%
summarize(
injury_count = n(),
.groups = "drop"
) %>%
pivot_wider(
names_from = injury,
values_from = injury_count
) %>%
group_by(county) %>%
mutate(
total.injuries = sum(c(minor,major,fatal), na.rm = TRUE)
) %>%
relocate("minor", "fatal", "none", .after = "major") %>%
arrange(desc(total.injuries))
sharks %>%
select(county, injury) %>%
mutate(injury = str_remove(injury, "\\*")) %>%
group_by(county, injury) %>%
summarize(
injury_count = n(),
.groups = "drop"
) %>%
pivot_wider(
names_from = injury,
values_from = injury_count
) %>%
group_by(county) %>%
mutate(
total.incidents = sum(c(minor,major,fatal,none), na.rm = TRUE)
) %>%
relocate("minor", "fatal", "none", .after = "major") %>%
arrange(desc(total.incidents))
shark_wide <- sharks %>%
select(county, injury) %>%
mutate(injury = str_remove(injury, "\\*")) %>%
group_by(county, injury) %>%
summarize(
injury_count = n(),
.groups = "drop"
) %>%
pivot_wider(
names_from = injury,
values_from = injury_count
) %>%
group_by(county) %>%
mutate(
total.incidents = sum(c(minor,major,fatal,none), na.rm = TRUE)
) %>%
relocate("minor", "fatal", "none", .after = "major") %>%
arrange(desc(total.incidents))
shark_wide
shark_wide %>%
ggplot(
mapping = aes(
x = county,
y = total.incidents,
fill = county
)
)+
geom_col()
shark_wide %>%
ggplot(
mapping = aes(
y = county,
x = total.incidents,
fill = county
)
)+
geom_col()
shark_wide %>%
ggplot(
mapping = aes(
y = county,
x = total.incidents,
fill = county
)
)+
geom_col()+
scale_fill_manual(
values = county_palette
)
shark_wide %>%
ggplot(
mapping = aes(
y = county,
x = total.incidents,
fill = county
)
)+
geom_col()+
scale_fill_manual(
values = county_palette
)+
theme(
legend.position = "none"
)
shark_wide %>%
ggplot(
mapping = aes(
y = county,
x = total.incidents,
fill = county
)
)+
geom_col()+
scale_fill_manual(
values = county_palette
)+
labs(
title = "Total Shark Incidents per County from 1950 to 2022",
x = "County",
y = "Total Incidents"
)+
theme(
legend.position = "none"
)
sharks %>%
count(mode, sort = TRUE)
sharks %>%
ggplot(
mapping = aes(
x = mode)
)+
geom_bar()
sharks %>%
ggplot(
mapping = aes(
x = mode)
)+
geom_bar()+
theme(
axis.text.x = element_text(
angle = 90,
hjust = 0.85)
)+
sharks %>%
ggplot(
mapping = aes(
x = mode)
)+
geom_bar()+
theme(
axis.text.x = element_text(
angle = 90,
hjust = 0.85)
)
sharks %>%
ggplot(
mapping = aes(
x = mode)
)+
geom_bar()+
theme(
axis.text.x = element_text(
angle = 30,
hjust = 0.85)
)
sharks %>%
ggplot(
mapping = aes(
x = mode)
)+
geom_bar()+
theme(
axis.text.x = element_text(
angle = 30,
hjust = 0.45)
)
sharks %>%
ggplot(
mapping = aes(
x = mode)
)+
geom_bar()+
theme(
axis.text.x = element_text(
angle = 30,
hjust = 0.75)
)
sharks %>%
ggplot(
mapping = aes(
x = mode)
)+
geom_bar()+
theme(
axis.text.x = element_text(
angle = 30,
hjust = 0.95)
)
sharks %>%
ggplot(
mapping = aes(
x = mode)
)+
geom_bar(color = "#4A7A67")+
theme(
axis.text.x = element_text(
angle = 30,
hjust = 0.95)
)
sharks %>%
ggplot(
mapping = aes(
x = mode)
)+
geom_bar(fill = "#4A7A67")+
theme(
axis.text.x = element_text(
angle = 30,
hjust = 0.95)
)
sharks %>%
ggplot(
mapping = aes(
x = mode)
)+
geom_bar(fill = "orange")+
theme(
axis.text.x = element_text(
angle = 30,
hjust = 0.95)
)+
labs(
)
sharks %>%
ggplot(
mapping = aes(
x = mode)
)+
geom_bar(fill = "orange")+
theme(
axis.text.x = element_text(
angle = 30,
hjust = 0.95)
)+
labs(
title = "Shark Incidents per Activity Type from 1950 to 2022",
x = "Activity Type",
y = "Count"
)
sharks %>%
count(species, sort = TRUE)
sharks %>%
count(species, sort = TRUE)
sharks %>%
filter(species == "White")
sharks %>%
select(county, injury, species) %>%
mutate(injury = str_remove(injury, "\\*")) %>%
group_by(county, injury) %>%
summarize(
injury_count = n(),
.groups = "drop"
) %>%
pivot_wider(
names_from = injury,
values_from = injury_count
) %>%
group_by(county) %>%
mutate(
total.incidents = sum(c(minor,major,fatal,none), na.rm = TRUE)
) %>%
relocate("minor", "fatal", "none", .after = "major") %>%
arrange(desc(total.incidents))
sharks %>%
select(county, species, injury) %>%
mutate(injury = str_remove(injury, "\\*")) %>%
group_by(county, injury) %>%
summarize(
injury_count = n(),
.groups = "drop"
) %>%
pivot_wider(
names_from = injury,
values_from = injury_count
) %>%
group_by(county) %>%
mutate(
total.incidents = sum(c(minor,major,fatal,none), na.rm = TRUE)
) %>%
relocate("minor", "fatal", "none", .after = "major") %>%
arrange(desc(total.incidents))
sharks_w %>%
filter(species == "White") %>%
select(injury)
sharks %>%
filter(species == "White") %>%
select(injury)
sharks %>%
filter(species == "White") %>%
select(injury) %>%
ggplot(
mapping = aes(
x = injury
)
)+
geom_bar
sharks %>%
filter(species == "White") %>%
select(injury) %>%
ggplot(
mapping = aes(
x = injury
)
)+
geom_bar()
sharks %>%
filter(species == "White") %>%
mutate(injury = str_remove(injury, "\\*")) %>%
ggplot(
mapping = aes(
x = injury
)
)+
geom_bar()
sharks %>%
filter(species == "White") %>%
mutate(injury = str_remove(injury, "\\*")) %>%
ggplot(
mapping = aes(
x = injury
)
)+
geom_bar(fill + "orange")+
labs(
title = "Injury Types of Great White Incidents between 1950 and 2022",
x = "Injury Type",
y = "Number of Incidents"
)
sharks %>%
filter(species == "White") %>%
mutate(injury = str_remove(injury, "\\*")) %>%
ggplot(
mapping = aes(
x = injury
)
)+
geom_bar(fill = "orange")+
labs(
title = "Injury Types of Great White Incidents between 1950 and 2022",
x = "Injury Type",
y = "Number of Incidents"
)
